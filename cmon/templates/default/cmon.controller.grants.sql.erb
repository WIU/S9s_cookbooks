SET SQL_LOG_BIN=0;
GRANT INSERT,UPDATE,DELETE,SELECT ON cmon.* TO 'cmon'@'127.0.0.1' IDENTIFIED BY '<%= node['cmon']['cmon_password'] %>';
GRANT INSERT,UPDATE,DELETE,SELECT ON cmon.* TO 'cmon'@'<%= node['cmon']['controller']['mysql_hostname'] %>' IDENTIFIED BY '<%= node['cmon']['cmon_password'] %>';
GRANT SUPER on *.* TO 'cmon'@'127.0.0.1' IDENTIFIED BY '<%= node['cmon']['cmon_password'] %>';
GRANT SUPER on *.* TO 'cmon'@'<%= node['cmon']['controller']['mysql_hostname'] %>' IDENTIFIED BY '<%= node['cmon']['cmon_password'] %>';
USE cmon;
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'OS','<%= node['platform'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CLUSTER_NAME','<%= node['cmon']['cluster_name'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'WWWROOT','<%= node['cmon']['misc']['wwwroot'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CMON_HOSTNAME','<%= node['cmon']['controller']['mysql_hostname'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CMON_PASSWORD','<%= node['cmon']['cmon_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'COREDIR','<%= node['cmon']['misc']['core_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SSH_USER','<%= node['cmon']['misc']['os_user'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SSH_IDENTITY',substr('<%= node['cmon']['misc']['IDENTITY2'] %>',3));
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BACKUPDIR','<%= node['cmon']['misc']['BACKUPDIR'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BACKUP_RETENTION','0');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'STAGING_DIR','/tmp');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'PURGE','7');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'LOG_COLLECTION','30');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'MYSQL_PORT','<%= node['cmon']['controller']['mysql_port'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'BINDIR','<%= node['cmon']['mysql']['bin_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'ROOT_PASSWORD','<%= node['cmon']['mysql']['root_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'REPL_PASSWORD','<%= node['cmon']['mysql']['repl_password'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'REPL_USER','<%= node['cmon']['mysql']['repl_user'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'NDB_CONNECTSTRING','<%= node['cmon']['controller']['ndb_connectstring'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'NDB_BINARY','<%= node['cmon']['mysql']['ndb_bin_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'SCRIPTDIR','<%= node['cmon']['mysql']['script_dir'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'PRE_INSTALLED_IMAGE',0);
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'INSTALL_METHOD','TGZ');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'OS_USER_HOME','<%= ENV['HOME'] %>');
INSERT IGNORE INTO cmon.cmon_configuration (cid, param, value) VALUES (1, 'CONFIGDIR','<%= node['cmon']['install_config_path'] %>');
INSERT IGNORE INTO cmon.cmon_sw_package (cid, packageid, name,rpm,selected) VALUES (1,1,'CMON_DEFAULT',0,1);
INSERT IGNORE INTO cmon.cmon_sw_package (cid, packageid, name,rpm,selected) VALUES (1,2,'MYSQL_INITIAL_DEPLOY',0,1);
